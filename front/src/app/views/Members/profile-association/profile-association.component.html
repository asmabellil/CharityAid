<section class="section about-section gray-bg" id="about">
    <div class="container">
        <div class="row align-items-center flex-row-reverse" [formGroup]="registerForm">
            <div class="col-lg-9 mb-3">
                <div class="about-text go-to">
                    <h3 class="dark-color" *ngIf="!state" (click)="update()" >{{associationToUpdate.Name}}</h3>
                    <div class="media" *ngIf="state">
                        <label style="color: #20247b; font-weight: 600; width: 100px;">Name /</label>
                        <input class="form-control"  type="text" name="name" placeholder="Name" [(ngModel)]="associationToUpdate.Name" formControlName="Name">
                    </div>   
                    <div class="col-md-12 px-3">
                        <div class="alert alert-danger" *ngIf="Name.errors && Name.touched">
                            <div *ngIf="Name.errors.required">This field is required</div>
                            <div *ngIf="Name.errors.minlength">Your name should have at leaset two charcters</div>
                          </div>
                    </div>
                    <div class="row about-list">
                        <div class="col-md-6">
                            <div class="media">
                                <label>Foundation date</label>
                                <p *ngIf="!state" (click)="update()">{{associationToUpdate.Foundation_date | date:'mediumDate'}}</p>
                                    <div class="mb-3 mat-calander col-md-6" *ngIf="state">
                                    <div class="row mt-2">
                                        <mat-datepicker-toggle matSuffix [for]="picker" class="col-md-3"></mat-datepicker-toggle>
                                        <mat-datepicker #picker></mat-datepicker>
                                        <input class="inputDatePicker form-control col-md-8" placeholder="   Foundation Date" matInput [matDatepicker]="picker" [(ngModel)]="associationToUpdate.Foundation_date" formControlName="Foundation_date">
                                    </div>
                                </div>
                            </div>
                            <div class="media">
                                <label>Siret Number</label>
                                <p *ngIf="!state" (click)="update()">{{associationToUpdate.Siret_Number}}</p>
                                <input class="form-control" *ngIf="state" type="text" name="Siret_Number" placeholder="Siret Number" [(ngModel)]="associationToUpdate.Siret_Number" formControlName="Siret_Number">
                            </div>
                            <div class="col-md-12 px-3">
                                <div class="alert alert-danger" *ngIf="Siret_Number.errors && Siret_Number.touched">
                                  <div *ngIf="Siret_Number.errors.required">This field is required</div>
                                  <div *ngIf="Siret_Number.errors.pattern">Your siret number should contain exactly 9 charcters</div>
                                </div>
                            </div>
                            <div class="media">
                                <label>Responsible</label>
                                <p *ngIf="!state" (click)="update()">{{associationToUpdate.Responsible}}</p>
                                <input class="form-control" *ngIf="state" type="text" name="Responsible" placeholder="Responsible" [(ngModel)]="associationToUpdate.Responsible" formControlName="Responsible">
                            </div>
                            <div class="col-md-12 px-3">
                                <div class="alert alert-danger" *ngIf="Responsible.errors && Responsible.touched">
                                    <div *ngIf="Responsible.errors.required">This field is required</div>
                                    <div *ngIf="Responsible.errors.pattern">This email should have this form test@test.com</div>
                                </div>
                            </div>
                            <div class="media">
                                <label>Address</label>
                                <p *ngIf="!state" (click)="update()">{{associationToUpdate.Adress}}</p>
                                <input class="form-control" *ngIf="state" type="text" name="Adress" placeholder="Adress" [(ngModel)]="associationToUpdate.Adress" formControlName="Adress">
                            </div>
                            <div class="col-md-12 px-3">
                                <div class="alert alert-danger" *ngIf="Adress.errors && Adress.touched">
                                    <div *ngIf="Adress.errors.required">This field is required</div>
                                    <div *ngIf="Adress.errors.minlength">Your adress should have at leaset three charcters</div>
                                  </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="media">
                                <label>E-mail</label>
                                <p *ngIf="!state" (click)="update()">{{associationToUpdate.Email}}</p>
                                <input class="form-control" *ngIf="state" type="text" name="Email" placeholder="Email" [(ngModel)]="associationToUpdate.Email" formControlName="Email">
                            </div>
                            <div class="col-md-12 px-3">
                                <div class="alert alert-danger" *ngIf="Email.errors && Email.touched">
                                    <div *ngIf="Email.errors.required">This field is required</div>
                                    <div *ngIf="Email.errors.pattern">Your email should have this form test@test.com</div>
                                  </div>
                            </div>
                            <div class="media">
                                <label>Phone</label>
                                <p *ngIf="!state" (click)="update()">{{associationToUpdate.Phone}}</p>
                                <input class="form-control" *ngIf="state" type="text" name="Phone" placeholder="Phone" [(ngModel)]="associationToUpdate.Phone" formControlName="Phone">
                            </div>
                            <div class="col-md-12 px-3">
                                <div class="alert alert-danger" *ngIf="Phone.errors && Phone.touched">
                                    <div *ngIf="Phone.errors.required">This field is required</div>
                                    <div *ngIf="Phone.errors.pattern">Your phone number should have exactly 8 numbers</div>
                                  </div>
                            </div>
                            <div class="media">
                                <label>Type</label>
                                <p *ngIf="!state" (click)="update()">{{associationToUpdate.Type}}</p>
                               <!--  <input class="form-control" *ngIf="state" type="text" name="Type" placeholder="Type" [(ngModel)]="associationToUpdate.Type" formControlName="Type"> -->
                               <mat-form-field appearance="fill" *ngIf="state">
                                <mat-label>Type</mat-label>
                                <mat-select required
                                    name="type"
                                    [(ngModel)]="associationToUpdate.Type"
                                    formControlName="Type">
                                  <mat-option value="Educationnal"> Educationnal </mat-option>
                                  <mat-option value="Health"> Health </mat-option>
                                  <mat-option value="Environmental"> Environmental </mat-option>
                                  <mat-option value="Animal"> Animal </mat-option>
                                  <mat-option value="Art and Culture"> Art and Culture </mat-option>
                                  <mat-option value="International NGOs"> International NGOs </mat-option>
                                  <mat-option value="volvo"> Other </mat-option>
                                </mat-select>
                                </mat-form-field>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3" *ngIf="!state">
                <div class="about-avatar">
                    <img (click)="update()" [src]="associationToUpdate.Picture" >
                </div>
            </div>
            <div class="col-lg-3" *ngIf="state">
            <ngx-dropzone (change)="onSelect($event)" [accept]="'image/png,image/jpeg,image/jpg'" >
                <ngx-dropzone-label>Select picture</ngx-dropzone-label>
                <ngx-dropzone-image-preview ngProjectAs="ngx-dropzone-preview" *ngFor="let f of files" [file]="f"  [removable]="true" (removed)="onRemove(f)" >
                <ngx-dropzone-label>({{ f.type }})</ngx-dropzone-label>
                </ngx-dropzone-image-preview>
            </ngx-dropzone>
            </div>
        </div>
        <div class="counter">
            <div class="row">
                <div class="col-6 col-lg-3">
                    <div class="count-data text-center">
                        <h6 class="count h2" >{{membersNumber}}</h6>
                        <p class="m-0px font-w-600">Members</p>
                    </div>
                </div>
                <div class="col-6 col-lg-3">
                    <div class="count-data text-center">
                        <h6 class="count h2">{{subscribersNumber}}</h6>
                        <p class="m-0px font-w-600">Subscribers</p>
                    </div>
                </div>
                <div class="col-6 col-lg-3">
                    <div class="count-data text-center">
                        <h6 class="count h2">{{eventsNumber}}</h6>
                        <p class="m-0px font-w-600">Events</p>
                    </div>
                </div>
                <div class="col-6 col-lg-3">
                    <div class="count-data text-center">
                        <h6 class="count h2">{{contactsNumber}}</h6>
                        <p class="m-0px font-w-600">Contacts</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container mt-3" style="display: flex; justify-content: center;" *ngIf="state">
        <button class="btn btn-outline-danger mr-5" (click)="cancel()"> Cancel </button>
        <button class="btn btn-outline-success" (click)="openModal(template)"> Edit </button>
    </div>
</section>
<ng-template #template>
<div class="modal-header">
    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body text-center">
    <p>Do you want to confirm ?</p>
    <button type="button" class="btn btn-primary" (click)="updateAsso(associationToUpdate)" >Yes</button>
    <button type="button" class="btn btn-default" (click)="modalRef.hide()" >No</button>
  </div>
</ng-template>